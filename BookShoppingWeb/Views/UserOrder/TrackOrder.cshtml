@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model Order
@{
    ViewData["Title"] = "Track Order";
}
<style>
    .tracker{
        display:flex;
        justify-content:space-between;
        margin: 40px 0;
        position:relative;
    }
    .tracker::before{
        content:"";
        position:absolute;
        top:15px;
        left:0;
        width:100%;
        height:4px;
        background:#e0e0e0;
    }
    .step{
        text-align:center;
        position:relative;
        width:25%;
    }
    .circle{
        width:30px;
        height:30px;
        border-radius:50%;
        background:#ccc;
        color:white;
        line-height:30px;
        margin:auto;
    }
    .active.circle{
        background:#28a745;
    }
    .step span{
        display:block;
        margin-top:8px;
    }
</style>

<div class="container mt-4">
    <h3>Order Tracking</h3>
    <hr/>

    <p><strong>Order ID:</strong>@Model.Id</p>
    <p><strong>Date:</strong>@Model.CreateDate.ToString("dd MMM yyyy")</p>

    <p>
        <strong>Payment:</strong>
        @if(Model.PaymentMeythod == "COD")
        {
            <span class="badge bg-warning text-dark">Cash On Delivery</span>
        }
        else
        {
            <span class="badge bg-success">Paid Online</span>
        }
    </p>
    @{
        string status = Model.OrderStatus.StatusName;
    }

    <!-- Order Sttaus Tracker -->
    <div class="tracker">
        <div class="step @(status=="Pending"||status=="Processing"||status=="Shipped"||status=="Delivered"?"active":"")">
            <div class="circle">✓</div>
            <span>Placed</span>
        </div>

        <div class="step @(status=="Processing"||status=="Shipped"||status=="Delivered"?"active":"")">
            <div class="circle">✓</div>
        </div>

        <div class="step @(status=="Shipped"||status=="Delivered"?"active":"")">
            <div class="circle">✓</div>
        </div>

        <div class="step@(status=="Delivered"?"active":"")">
            <div class="circle">✓</div>
            <span>Delivered</span>
        </div>
    </div>

    <h5>Items</h5>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Book</th>
                <th width="100">Qty</th>
                <th width="120">Price</th>
                <th width="120">Total</th>
            </tr>
        </thead>
        <tbody>
            @{
                double total = 0;
            }
            @foreach(var item in Model.OrderDetail)
            {
                var lineTotal = item.UnitPrice * item.Quantity;
                total += lineTotal;

                <tr>
                    <td>@item.Book.BookName</td>
                    <td>@item.Quantity</td>
                    <td>$@item.UnitPrice</td>
                    <td>$@lineTotal</td>
                </tr>
            }
        </tbody>
    </table>
    <div class="text-end">
        <h4>Total:$@total</h4>
    </div>
    <hr/>
    <h5>Delivery Address:</h5>
    <p>@Model.Address</p>
    <a href="/UserOrder/UserOrders" class="btn btn-secondary">Back</a>
</div>